{
  "openapi": "3.0.3",
  "info": {
    "title": "Mr. Nwosu Blog API",
    "description": "API for programmatically creating blog posts. Supports scheduling posts for future publication (published daily at 8 AM EST). Requires an API key generated from the admin dashboard.",
    "version": "1.0.0",
    "contact": {
      "name": "Mr. Nwosu"
    }
  },
  "servers": [
    {
      "url": "/api",
      "description": "Current server"
    }
  ],
  "security": [
    {
      "ApiKeyAuth": []
    }
  ],
  "paths": {
    "/blog": {
      "post": {
        "summary": "Create a new blog post",
        "description": "Creates a new blog post. The post will be published immediately unless `draft: true` is specified. Tags are created automatically if they don't exist.",
        "operationId": "createBlogPost",
        "tags": ["Blog"],
        "security": [
          {
            "ApiKeyAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateBlogPost"
              },
              "examples": {
                "basic": {
                  "summary": "Basic post",
                  "value": {
                    "title": "My First Post",
                    "content": "# Hello World\n\nThis is my first blog post written in **markdown**."
                  }
                },
                "full": {
                  "summary": "Full post with all options",
                  "value": {
                    "title": "Complete Example Post",
                    "content": "# Introduction\n\nThis post demonstrates all available options.\n\n## Code Example\n\n```javascript\nconsole.log('Hello!');\n```\n\n## Conclusion\n\nThanks for reading!",
                    "tags": ["tutorial", "javascript"],
                    "featuredImage": "https://example.com/image.jpg",
                    "draft": false
                  }
                },
                "draft": {
                  "summary": "Save as draft",
                  "value": {
                    "title": "Work in Progress",
                    "content": "This is a draft post that won't be published yet.",
                    "draft": true
                  }
                },
                "scheduled": {
                  "summary": "Schedule for future",
                  "value": {
                    "title": "Future Post",
                    "content": "# Coming Soon\n\nThis post will be published automatically on the scheduled date.",
                    "scheduledAt": "2025-01-15T13:00:00Z"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Blog post created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BlogPostResponse"
                },
                "example": {
                  "id": "clxyz123abc",
                  "slug": "my-first-post",
                  "title": "My First Post",
                  "published": true
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationError"
                },
                "example": {
                  "error": "Validation failed",
                  "details": {
                    "fieldErrors": {
                      "title": ["Title is required"]
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Missing or invalid API key",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "error": "Invalid API key"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "error": "Internal server error"
                }
              }
            }
          }
        }
      },
      "put": {
        "summary": "Update an existing blog post",
        "description": "Updates an existing blog post identified by its slug. Only include fields you want to update - omitted fields remain unchanged. Tags are replaced entirely if provided.",
        "operationId": "updateBlogPost",
        "tags": ["Blog"],
        "security": [
          {
            "ApiKeyAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateBlogPost"
              },
              "examples": {
                "updateTitle": {
                  "summary": "Update title only",
                  "value": {
                    "slug": "my-first-post",
                    "title": "My Updated Post Title"
                  }
                },
                "updateContent": {
                  "summary": "Update content",
                  "value": {
                    "slug": "my-first-post",
                    "content": "# Updated Content\n\nThis is the new content for my blog post."
                  }
                },
                "updateTags": {
                  "summary": "Replace tags",
                  "value": {
                    "slug": "my-first-post",
                    "tags": ["updated", "new-tag"]
                  }
                },
                "publishDraft": {
                  "summary": "Publish a draft",
                  "value": {
                    "slug": "my-draft-post",
                    "draft": false
                  }
                },
                "fullUpdate": {
                  "summary": "Update multiple fields",
                  "value": {
                    "slug": "my-first-post",
                    "title": "Completely Revised Post",
                    "content": "# New Content\n\nCompletely rewritten.",
                    "tags": ["revised", "updated"],
                    "featuredImage": "https://example.com/new-image.jpg"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Blog post updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BlogPostResponse"
                },
                "example": {
                  "success": true,
                  "post": {
                    "id": "clxyz123abc",
                    "slug": "my-first-post",
                    "title": "My Updated Post Title",
                    "published": true,
                    "scheduledAt": null,
                    "createdAt": "2024-12-20T10:00:00.000Z",
                    "tags": ["updated", "new-tag"]
                  }
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationError"
                },
                "example": {
                  "error": "Validation failed",
                  "details": {
                    "fieldErrors": {
                      "slug": ["Slug is required to identify the post"]
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Missing or invalid API key",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "error": "Invalid API key"
                }
              }
            }
          },
          "404": {
            "description": "Blog post not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "error": "Blog post not found"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "error": "Internal server error"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "ApiKeyAuth": {
        "type": "apiKey",
        "in": "header",
        "name": "x-api-key",
        "description": "API key generated from the admin dashboard. Format: `mrnw_xxxxx...`"
      }
    },
    "schemas": {
      "CreateBlogPost": {
        "type": "object",
        "required": ["title", "content"],
        "properties": {
          "title": {
            "type": "string",
            "minLength": 1,
            "description": "The title of the blog post. A URL-friendly slug will be auto-generated from this.",
            "example": "My Awesome Blog Post"
          },
          "content": {
            "type": "string",
            "minLength": 1,
            "description": "The blog post content in Markdown format. Supports headings, code blocks, lists, links, images, and more.",
            "example": "# Introduction\n\nThis is my post content in **markdown**."
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Array of tag names. Tags will be created automatically if they don't exist.",
            "example": ["tech", "tutorial"]
          },
          "featuredImage": {
            "type": "string",
            "format": "uri",
            "description": "URL to a featured image for the post.",
            "example": "https://example.com/image.jpg"
          },
          "draft": {
            "type": "boolean",
            "default": false,
            "description": "If true, the post will be saved as a draft and not published. Default is false (published immediately)."
          },
          "date": {
            "type": "string",
            "format": "date-time",
            "description": "Custom publish date in ISO 8601 format. If not provided, defaults to current date/time.",
            "example": "2024-12-25T10:30:00Z"
          },
          "scheduledAt": {
            "type": "string",
            "format": "date-time",
            "description": "Schedule the post to publish at a future date/time (ISO 8601). Posts are auto-published at 8 AM EST daily. If set to a future date, the post is saved as scheduled (not published until cron runs).",
            "example": "2025-01-15T13:00:00Z"
          }
        }
      },
      "UpdateBlogPost": {
        "type": "object",
        "required": ["slug"],
        "properties": {
          "slug": {
            "type": "string",
            "minLength": 1,
            "description": "The slug of the blog post to update. This identifies which post to modify.",
            "example": "my-first-post"
          },
          "title": {
            "type": "string",
            "minLength": 1,
            "description": "New title for the blog post.",
            "example": "My Updated Blog Post"
          },
          "content": {
            "type": "string",
            "minLength": 1,
            "description": "New content for the blog post in Markdown format.",
            "example": "# Updated Content\n\nThis is the new content."
          },
          "description": {
            "type": "string",
            "description": "New description/subtitle for the blog post.",
            "example": "A revised description"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "New array of tag names. Replaces all existing tags. Tags are created automatically if they don't exist.",
            "example": ["updated", "revised"]
          },
          "featuredImage": {
            "type": "string",
            "format": "uri",
            "nullable": true,
            "description": "URL to a new featured image. Set to null to remove the current image.",
            "example": "https://example.com/new-image.jpg"
          },
          "draft": {
            "type": "boolean",
            "description": "Set to true to unpublish (convert to draft), or false to publish."
          },
          "date": {
            "type": "string",
            "format": "date-time",
            "description": "Update the publish date in ISO 8601 format.",
            "example": "2024-12-25T10:30:00Z"
          },
          "scheduledAt": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "Schedule the post for future publication (ISO 8601). Set to null to clear the schedule.",
            "example": "2025-01-15T13:00:00Z"
          }
        }
      },
      "BlogPostResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the blog post",
            "example": "clxyz123abc"
          },
          "slug": {
            "type": "string",
            "description": "URL-friendly slug generated from the title",
            "example": "my-awesome-blog-post"
          },
          "title": {
            "type": "string",
            "description": "The title of the blog post",
            "example": "My Awesome Blog Post"
          },
          "published": {
            "type": "boolean",
            "description": "Whether the post is published or a draft",
            "example": true
          },
          "scheduledAt": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "When the post is scheduled to publish (null if not scheduled or already published)",
            "example": "2025-01-15T13:00:00Z"
          }
        }
      },
      "Error": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "description": "Error message"
          }
        }
      },
      "ValidationError": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "example": "Validation failed"
          },
          "details": {
            "type": "object",
            "properties": {
              "fieldErrors": {
                "type": "object",
                "additionalProperties": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
